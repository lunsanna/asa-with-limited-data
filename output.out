06/27/2023 09:32:47 - DEBUG - __main__ -   Running on cuda
06/27/2023 09:32:47 - DEBUG - __main__ -   Cuda count: 4
********** Runing fold 0 ********** 
LOAD PRE-TRAINED PROCESSOR AND MODEL
06/27/2023 09:32:47 - DEBUG - __main__ -   Pre-trained processor loaded. Time: 0:00:00.  Size: 0G.
06/27/2023 09:32:47 - DEBUG - __main__ -   CPU mem usage: 0.40G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

06/27/2023 09:32:51 - DEBUG - __main__ -   Pre-trained model loaded. Time: 0:00:03.  Size: 0G.
06/27/2023 09:32:51 - DEBUG - __main__ -   CPU mem usage: 2.00G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

LOAD DATA
06/27/2023 09:32:51 - INFO - __main__ -   15 training samples, 5 validation samples.
06/27/2023 09:32:51 - DEBUG - __main__ -   Training set: speech successfully loaded. Time: 0:00:00.  Size: 0G.
06/27/2023 09:32:51 - DEBUG - __main__ -   CPU mem usage: 2.05G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

06/27/2023 09:32:51 - DEBUG - __main__ -   Validation set: speech successfully loaded. Time: 0:00:00.  Size: 0G.
06/27/2023 09:32:51 - DEBUG - __main__ -   CPU mem usage: 2.07G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

06/27/2023 09:32:53 - DEBUG - __main__ -   Training set: features and labels sucessfully extracted. Time: 0:00:01.  Size: 0G.
06/27/2023 09:32:53 - DEBUG - __main__ -   CPU mem usage: 2.02G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

06/27/2023 09:32:53 - WARNING - datasets.arrow_dataset -   num_proc must be <= 5. Reducing num_proc to 5 for dataset of size 5.
06/27/2023 09:32:54 - DEBUG - __main__ -   Validation set: features and labels sucessfully extracted. Time: 0:00:01.  Size: 0G.
06/27/2023 09:32:54 - DEBUG - __main__ -   CPU mem usage: 2.00G
Cuda 0: memory acclocated: 0 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

TRAIN
06/27/2023 09:32:54 - INFO - torch.distributed.distributed_c10d -   Added key: store_based_barrier_key:1 to store for rank: 0
06/27/2023 09:32:54 - INFO - torch.distributed.distributed_c10d -   Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
06/27/2023 09:32:54 - DEBUG - urllib3.connectionpool -   Starting new HTTPS connection (1): s3.amazonaws.com:443
06/27/2023 09:32:54 - DEBUG - urllib3.connectionpool -   https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/metrics/evaluate-metric/wer/evaluate-metric/wer.py HTTP/1.1" 404 0
06/27/2023 09:32:54 - DEBUG - urllib3.connectionpool -   Starting new HTTPS connection (1): huggingface.co:443
06/27/2023 09:32:54 - DEBUG - urllib3.connectionpool -   https://huggingface.co:443 "HEAD /spaces/evaluate-metric/wer/resolve/v0.4.0/wer.py HTTP/1.1" 200 0
06/27/2023 09:32:54 - DEBUG - urllib3.connectionpool -   Starting new HTTPS connection (1): s3.amazonaws.com:443
06/27/2023 09:32:55 - DEBUG - urllib3.connectionpool -   https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/metrics/evaluate-metric/cer/evaluate-metric/cer.py HTTP/1.1" 404 0
06/27/2023 09:32:55 - DEBUG - urllib3.connectionpool -   Starting new HTTPS connection (1): huggingface.co:443
06/27/2023 09:32:55 - DEBUG - urllib3.connectionpool -   https://huggingface.co:443 "HEAD /spaces/evaluate-metric/cer/resolve/v0.4.0/cer.py HTTP/1.1" 200 0
06/27/2023 09:32:57 - DEBUG - __main__ -   Training starts now.
CPU mem usage: 2.04G
Cuda 0: memory acclocated: 4 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

06/27/2023 09:32:59 - DEBUG - __main__ -   CPU mem usage: 2.41G
Cuda 0: memory acclocated: 15 G.
Cuda 1: memory acclocated: 0 G.
Cuda 2: memory acclocated: 0 G.
Cuda 3: memory acclocated: 0 G.

{'input_values': tensor([[[ 0.0001,  0.0001,  0.0001,  ..., -0.0008, -0.0005, -0.0005]]]), 'attention_mask': tensor([[1]], dtype=torch.int32), 'labels': tensor([[33, 17,  4, 23,  7, 10, 26, 26,  7,  4, 17, 10, 26, 32,  4, 17, 16,  7,
          4,  6, 32, 13, 26,  5, 32,  4,  8,  9,  4, 33, 33,  4, 25, 10, 13,  8,
         12, 12,  7,  4,  8,  9,  4, 22, 26, 12, 10,  4, 12,  7,  7, 13, 10,  4,
         33, 33,  4, 11, 10, 10, 14,  5,  9, 17,  7,  7,  4,  8,  9,  4, 12, 16,
          8, 17,  5, 26, 12, 10,  4, 33, 17,  4, 12,  5,  4, 33, 33,  4, 12,  5,
          4,  8,  9,  4, 17, 16,  9,  4, 15,  5, 17, 23, 10, 23,  7, 10, 26, 26,
          7,  4, 26,  8, 12, 26,  7,  4, 26, 16,  9,  4, 17, 32,  4, 26, 32, 22,
          9,  4, 12, 10,  5, 15, 15, 32,  4, 29,  8, 26,  7,  4, 26,  5, 12, 32,
          4, 33, 33,  4, 17, 32,  4, 12,  7,  7,  9,  4, 25, 10,  5,  6,  6, 32,
         32,  4,  7, 10, 26,  7,  7,  4, 22, 12,  6, 32, 25, 10,  5,  9,  4, 26,
          7,  9, 12,  7,  4, 29,  7,  4, 17, 16, 15,  4,  5, 10,  4,  6, 32, 11,
          4,  5, 10,  4,  6, 32, 22,  6, 22,  4,  6,  5, 11, 14, 32,  4, 17, 10,
          6, 32, 32,  9,  4, 33, 17,  4, 12,  5,  4,  8,  9,  4,  6,  8, 12, 10,
          4, 13,  7, 16, 11,  7, 15, 15, 10,  9,  5,  9,  4, 23,  7, 10, 26, 26,
          7,  4, 29,  7,  4, 12,  5,  4, 33, 33,  4, 12,  5,  4,  8,  9,  4, 23,
          7, 10, 26, 26,  7,  4, 17, 10, 12, 12, 32,  4, 17, 32,  4, 12,  7,  7,
          9,  4,  9, 10, 10,  9, 26, 16,  4,  9, 10, 10,  9, 26, 16,  4,  8, 15,
         15,  7,  4, 13,  7, 16, 11,  7, 15, 15, 10, 12,  6,  7,  4, 29,  7,  4,
         17, 32,  4,  5,  9,  4, 17, 16, 15,  4,  5, 10,  4,  6, 32, 22, 14, 22,
          4, 26,  5, 12, 26,  5,  9,  4,  6,  5, 11, 32,  4, 26,  8, 16, 15, 16,
          9,  4,  6,  7, 10,  4, 29,  8,  6,  7, 10,  9,  4, 12,  5, 15, 15,  7,
         10, 12,  5,  9,  4, 29,  7,  4, 12,  5,  4,  8,  9,  4,  8, 15, 15, 16,
          6,  4,  6, 32, 13, 26,  5, 32,  4, 17, 16, 15, 15,  5,  4,  9, 10, 10,
          9,  4, 26, 16,  9,  4, 29,  4, 29,  8,  4, 26,  8, 26,  8,  9,  4,  5,
         15, 32, 17, 32,  9,  4, 26,  8, 12, 26,  7,  4, 17, 32,  4,  8,  8,  9,
          4, 26, 32, 22,  9, 22,  6,  4, 12, 10,  5, 15,  4, 29,  8, 26,  8,  4,
         26,  5, 12, 32]])}
CausalLMOutput(loss={'logits': tensor([[[11.3906, -9.0859, -8.7891,  ..., -2.5020, -3.2852, -7.5898],
         [11.4375, -9.1250, -8.8359,  ..., -2.5352, -3.2812, -7.6289],
         [11.4766, -9.0859, -8.8203,  ..., -2.4980, -3.1250, -7.5898],
         ...,
         [10.4766, -9.2109, -8.9375,  ..., -1.5225, -1.9238, -7.7148],
         [10.3750, -9.1797, -8.9062,  ..., -1.3770, -1.8027, -7.6719],
         [ 9.1953, -8.5469, -8.1016,  ...,  1.3828,  2.0938, -7.0273]]],
       device='cuda:0')}, logits=tensor([[[11.3906, -9.0859, -8.7891,  ..., -2.5020, -3.2852, -7.5898],
         [11.4375, -9.1250, -8.8359,  ..., -2.5352, -3.2812, -7.6289],
         [11.4766, -9.0859, -8.8203,  ..., -2.4980, -3.1250, -7.5898],
         ...,
         [10.4766, -9.2109, -8.9375,  ..., -1.5225, -1.9238, -7.7148],
         [10.3750, -9.1797, -8.9062,  ..., -1.3770, -1.8027, -7.6719],
         [ 9.1953, -8.5469, -8.1016,  ...,  1.3828,  2.0938, -7.0273]]],
       device='cuda:0'), hidden_states=None, attentions=None)
